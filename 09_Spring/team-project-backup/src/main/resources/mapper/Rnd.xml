<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sh.haagendazo.bio.mapper.ProjectDocumentMapper">
<resultMap type="RndDTO" id="RndParam">
		<result property="userNo" column="user_no"/>
		<result property="userName" column="user_name"/>
		<result property="projectId" column="project_id" />
		<result property="projectName" column="project_name" />
		<result property="docName" column="doc_name"/>
		<result property="docType" column="doc_type" javaType="java.lang.String"/>
		<result property="filePath" column="file_path"/>
		<result property="uploadedBy" column="uploaded_by"/>
		<result property="uploadedAt" column="uploaded_at"/>
		<result property="labId" column="lab_id"/>
		<result property="labName" column="lab_name"/>
		<result property="location" column="location"/>
		<result property="contact" column="contact"/>
		<result property="type" column="type"/>
</resultMap>
 <select id="allRnd" resultMap="RndParam">
  SELECT user_no, user_name, project.project_id, project_name, doc_name, doc_type, file_path, uploaded_by, uploaded_at, lab.lab_id, lab_name, location, contact, type from project join project_document using (project_id) left join project_member using (project_id) left join lab using (lab_id) left join storage using (lab_id) left join user_info on (user_id = user_no); 
 </select>
 
 <select id="searchRnd" parameterType="RndDTO" resultMap="RndParam">
  select user_no, user_name, project.project_id, project_name, doc_name, doc_type, file_path, uploaded_by, uploaded_at, lab.lab_id, lab_name, location, contact, type from project join project_document using (project_id) left join project_member using (project_id) left join lab using (lab_id) left join storage using (lab_id) left join user_info on (user_id = user_no)
 <where>
	 <choose>
		 <when test="select == 'projectName'">
		 project_name LIKE CONCAT('%', #{keyword}, '%')</when>
		 <when test="select == 'docName'">
		 doc_name LIKE CONCAT('%', #{keyword}, '%')</when>
		 <when test="select == 'uploadedBy'">
		 uploaded_by LIKE CONCAT('%', #{keyword}, '%')</when>
	 </choose>
 </where>
 </select>
 
 <insert id="insertProject"></insert>
 
 <update id="updateProject"></update>
 
 <delete id="deleteRnd" parameterType="String">
 	DELETE FROM project WHERE project_id= #{projectId};
 </delete>
 
</mapper>